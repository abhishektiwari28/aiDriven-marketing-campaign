# Technical Requirements & Integration Guide

This document specifies the mandatory APIs, infrastructure, and tracking strategies required to achieve full project functionality.

## 1. Core API Requirements

### Advertising & Performance
| Platform | Required API | Key Functionality |
| :--- | :--- | :--- |
| **Meta (FB/Insta)** | Meta Marketing API | Create/Update ads, fetch real-time spend and conversion data. |
| **Google Ads** | Google Ads API | Manage bids, fetch search/display performance metrics. |
| **Email** | SendGrid/Mailchimp API| Trigger personalized email sequences and track open/click events. |

### Governance & Security
| Service | Requirement | Purpose |
| :--- | :--- | :--- |
| **Governance Engine** | Policy Engine (OPA/Custom) | Validates AI plans against brand rules and budget hard-caps. |
| **Audit Service** | Immutable Database | Stores every AI decision, prompt, and output for compliance. |
| **Storage Service** | AWS S3 / GCP Storage | Stores generated ad assets, plan artifacts, and historical data. |

### Operational & Data
| Platform | Required API | Key Functionality |
| :--- | :--- | :--- |
| **Adobe Workfront** | Workfront API (REST) | Sync tasks, assets, and approval statuses between creative and marketing teams. |
| **CRM (Salesforce)** | Salesforce REST API | Fetch customer segments and record conversion life-cycles. |
| **AI Backend** | Google Gemini API | Strategic reasoning, text generation, and ad performance analysis. |

---

## 2. Tracking Clicks & Conversions
To ensure the AI agents receive accurate feedback from every platform (Meta, Insta, Google, Email), we implement a **Triple-Layer Tracking Strategy**:

### Layer 1: Unified UTM Tagging (The "ID" Layer)
Every link generated by the platform will follow a strict UTM convention.
*   `utm_source`: e.g., `google`, `meta`, `email`
*   `utm_medium`: e.g., `cpc`, `display`, `newsletter`
*   `utm_campaign`: e.g., `winter_sale_2025`
*   **Unique Trace ID**: `cid={agent_id}` (Custom ID used by our AI to link the click to a specific agent decision).

### Layer 2: Client-Side Pixels (The "Real-Time" Layer)
- **Meta Pixel & Conversion API (CAPI)**: Tracks views and clicks in browser while sending server-side events to bypass ad-blockers.
- **Google Tag (gtag.js)**: Tracks Google Ads and Organic Search interactions.

### Layer 3: Server-Side Redirector/Webhook (The "Final Truth" Layer)
For **Email** and **direct SMS**, clicks go through our internal redirect service:
1. User clicks `https://api.campaign.ai/track/click?target=...&cid=123`.
2. Our backend logs the click event into the Vector DB immediately.
3. User is redirected to the destination URL.
4. **Benefit**: 100% accurate tracking of clicks without relying on client-side JS.

---

## 3. Infrastructure & Security
- **Vector Database**: Pinecone or Weaviate (for AI long-term memory).
- **Relational Database**: PostgreSQL (for structured metrics and user data).
- **Environment Secrets**: Secure storage for all API keys (Meta App Secret, Google Developer Token, etc.).
- **Compliance**: GDPR/CCPA compliant data handling (Anonymizing user PII before sending to LLM).

## 4. Operational Prerequisites
- [ ] Meta Business Manager Verified Account.
- [ ] Google Ads Developer Token (Basic Access).
- [ ] SendGrid Verified Sender Identity.
- [ ] Adobe Workfront API Service Account.
